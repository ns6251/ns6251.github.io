<!doctype html><html lang=en data-mode=light><head prefix="og: http://ogp.me/ns#"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.98.0"><meta name=theme content="Color Your World -- gitlab.com/rmaguiar/hugo-theme-color-your-world"><title>PhantomData&lt;T>ã¨traitå¢ƒç•Œ</title><meta name=author content="ns6251"><meta name=robots content="index follow"><link rel=canonical href=https://ns6251.github.io/posts/phantomdata-trait-bound/><meta property="og:site_name" content="ns6251ã®ãƒ–ãƒ­ã‚°"><meta property="og:title" content="PhantomDataã¨traitå¢ƒç•Œ"><meta property="og:url" content="https://ns6251.github.io/posts/phantomdata-trait-bound/"><meta property="og:type" content="article"><meta property="article:published_time" content="2022-05-15"><meta property="article:modified_time" content="2022-05-15"><meta property="og:updated_time" content="2022-05-15"><meta name=twitter:creator content="@ns6251"><meta name=twitter:site content="@ns6251"><meta name=theme-color content="#222"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebSite","@id":"https:\/\/ns6251.github.io\/"},"headline":"PhantomData\u003cT\u003eã¨traitå¢ƒç•Œ","description":"","url":"https:\/\/ns6251.github.io\/posts\/phantomdata-trait-bound\/","inLanguage":"en","datePublished":"2022-05-15","dateModified":"2022-05-15","wordCount":"255","publisher":{"@type":"Person","name":"ns6251"},"author":{"@type":"Person","name":"ns6251","description":"ğŸ¦€â¤","sameAs":["https://github.com/ns6251","https://qiita.com/ns6251","https://twitter.com/ns6251"]}}</script><link rel=stylesheet href=https://ns6251.github.io/css/main.min.1b397ce64f949bf1c8ebbbaebab50c4d68060e934f84b36d4e4af4b516c1f0d0.css integrity="sha256-Gzl85k+Um/HI67uuurUMTWgGDpNPhLNtTkr0tRbB8NA=" crossorigin=anonymous><noscript><meta name=theme-color content="#1dbc91" media="(prefers-color-scheme: dark)"><meta name=theme-color content="#1f676b" media="(prefers-color-scheme: light)"><link rel=stylesheet href=https://ns6251.github.io/css/noscript.min.9bacd85b6f1d42296c56d3b8457d0c13a4e7f415c4ca5fc8affb6ed6b39cad72.css integrity="sha256-m6zYW28dQilsVtO4RX0ME6Tn9BXEyl/Ir/tu1rOcrXI=" crossorigin=anonymous></noscript><link rel=preload href=/fonts/open-sans-v17-latin-700.woff2 as=font crossorigin=anonymous><link rel=preload href=/fonts/open-sans-v17-latin-italic.woff2 as=font crossorigin=anonymous><link rel=preload href=/fonts/open-sans-v17-latin-regular.woff2 as=font crossorigin=anonymous><link rel=preload href=/fonts/oswald-v29-latin-700.woff2 as=font crossorigin=anonymous><link rel=me href=https://github.com/ns6251><link rel=me href=https://qiita.com/ns6251><link rel=me href=https://twitter.com/ns6251><script src=https://ns6251.github.io/js/main.f1da21dfea83dc0c36cea0b202c14a97e00aedab567e32702eb120f5ab8d974b.js integrity="sha256-8doh3+qD3Aw2zqCyAsFKl+AK7atWfjJwLrEg9auNl0s=" crossorigin=anonymous></script></head><body><header><a href=/>ns6251ã®ãƒ–ãƒ­ã‚°</a><nav aria-label="Main menu."><ul><li><a class=btn href=/about/>About</a></li><li><a class=btn href=/posts/>Posts</a></li></ul></nav></header><div class=filler><main><article><header><h1>PhantomData<t>ã¨traitå¢ƒç•Œ</h1><p>Published on <time datetime=2022-05-15>2022-05-15</time></p></header><p>ã„ã¤ã‚‚ã ã£ãŸã‚‰Twitterã§ã€Œã«ã‚ƒãƒ¼ã‚“ã€ã¨ã„ã£ã¦ãŠã—ã¾ã„ã«ã—ã¦ã—ã¾ã†äº›ç´°ãªå¼•ã£æ›ã‹ã‚Šã‚’ï¼Œæ•¢ãˆã¦æ›¸ãèµ·ã“ã—ã¦ã¿ã‚‹ï¼</p><h2 id=tldr><a class=anchor href=#tldr title="Anchor for: TL:DR."><svg aria-hidden="true"><use xlink:href="/img/bundle.min.400384900ca9c1c2b3d867283b9f34c2.svg#hashtag"/></svg></a>TL:DR</h2><p><code>PhantomData&lt;T></code>ã®<code>T</code>ã®traitå¢ƒç•Œã®ã›ã„ã§å®Ÿè£…ã—ãŸï¼ˆã¨æ€ã£ãŸï¼‰<code>Clone</code>, <code>Copy</code>ãŒã¯ãŒã•ã‚Œã¦æ‚²ã—ã‹ã£ãŸğŸ˜¢ã¨ã„ã†è©±ï¼</p><p><a href="https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=24830c5237335c4e896c747592892413">playgroundã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰</a>ï¼</p><h2 id=å°å…¥><a class=anchor href=#å°å…¥ title="Anchor for: å°å…¥."><svg aria-hidden="true"><use xlink:href="/img/bundle.min.400384900ca9c1c2b3d867283b9f34c2.svg#hashtag"/></svg></a>å°å…¥</h2><p>ä¾‹ãˆã°ï¼Œæ§˜ã€…ãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®IDã¨ãªã‚‹å‹ã‚’ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ã£ã¦å®šç¾©ã—ãŸã¨ã™ã‚‹ï¼
<code>PhantomData</code>ã¯ãã®åã®é€šã‚Šå®Ÿæ…‹ã®ãªã„å‹ã§ã‚ã‚‹ï¼ï¼ˆ<a href=https://doc.rust-jp.rs/rust-by-example-ja/generics/phantom.html>Rust By Exampleå‚ç…§</a>ï¼‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Clone, Copy, PertialEq, Eq, Ord, PertialOrd, Hash)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Id</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    id: <span style=color:#66d9ef>u32</span>,
</span></span><span style=display:flex><span>    _marker: <span style=color:#a6e22e>PhantomData</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>User</code>ã¨ã„ã†ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å ´åˆï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«<code>Id</code>ã‚’åˆ©ç”¨ã™ã‚‹ï¼</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> id: <span style=color:#a6e22e>Id</span><span style=color:#f92672>&lt;</span>Self<span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> name: String,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ã“ã®ã‚¤ãƒ‡ã‚£ã‚ªãƒ ï¼Ÿã‚’åˆ©ç”¨ã™ã‚‹ã¨å¤§é‡ã®<code>SomeEntityId</code>ã¿ãŸã„ãªstructã®å®šç¾©ã‚’ã‚µãƒœã‚‹ã“ã¨ãŒã§ãã‚‹ï¼</p><h2 id=æ‚²ã—ã‹ã£ãŸã“ã¨><a class=anchor href=#æ‚²ã—ã‹ã£ãŸã“ã¨ title="Anchor for: æ‚²ã—ã‹ã£ãŸã“ã¨."><svg aria-hidden="true"><use xlink:href="/img/bundle.min.400384900ca9c1c2b3d867283b9f34c2.svg#hashtag"/></svg></a>æ‚²ã—ã‹ã£ãŸã“ã¨</h2><p>ã“ã‚ŒãŒå‡ºæ¥ãªã„ï¼</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> user <span style=color:#f92672>=</span> User::new();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> user_id <span style=color:#f92672>=</span> user.id.clone();
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;{:?}, {:?}&#34;</span>, user, user_id);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ã“ã‚“ãªã‚¨ãƒ©ãƒ¼ã‚’åãï¼</p><pre aria-label="Box containing code sample." tabindex=0><code>error[E0599]: the method `clone` exists for struct `Id&lt;User&gt;`, but its trait bounds were not satisfied
  --&gt; src/main.rs:39:27
   |
6  | pub struct Id&lt;T&gt; {
   | ----------------
   | |
   | method `clone` not found for this
   | doesn&#39;t satisfy `Id&lt;User&gt;: Clone`
...
21 | pub struct User {
   | --------------- doesn&#39;t satisfy `User: Clone`
...
39 |     let user_id = user.id.clone();
   |                           ^^^^^ method cannot be called on `Id&lt;User&gt;` due to unsatisfied trait bounds
   |
note: the following trait bounds were not satisfied because of the requirements of the implementation of `Clone` for `_`:
      `User: Clone`
  --&gt; src/main.rs:5:17
   |
5  | #[derive(Debug, Clone, Copy, PartialEq, Eq, Ord, PartialOrd, Hash)]
   |                 ^^^^^
   = help: items from traits can only be used if the trait is implemented and in scope
   = note: the following trait defines an item `clone`, perhaps you need to implement it:
           candidate #1: `Clone`
   = note: this error originates in the derive macro `Clone` (in Nightly builds, run with -Z macro-backtrace for more info)
help: consider annotating `User` with `#[derive(Clone)]`
   |
21 | #[derive(Clone)]
   |
</code></pre><p>è¦ã¯ï¼Œ<code>Id&lt;T></code>ã«ã¯<code>Clone</code>ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŒï¼Œ<code>User</code>ã«ã¯<code>Clone</code>ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã„ãŸã‚ï¼Œ<code>Id&lt;User></code>ã§ã¯ï¼Œ
<code>Clone</code>ãŒã¯ãŒã•ã‚Œã¦ï¼Ÿæ€’ã‚‰ã‚Œã¦ã„ã‚‹ï¼ï¼ˆã“ã‚Œã¯<code>Copy</code>ã‚„ï¼Œãã®ãŸderiveã—ãŸã¯ãšã®traitã§ã‚‚åŒæ§˜ã§ã‚ã‚‹ï¼ï¼‰</p><p>ã¤ã¾ã‚Šï¼Œ<code>Id&lt;User></code>ã®ä¸­ã®ï¼Œ<code>_marker: PhantomData&lt;User></code>ã«<code>Clone</code>ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã„ã“ã¨ãŒå•é¡Œã¨ãªã£ã¦ã„ã‚‹<sup id=fnref:1><a href=#fn:1 class=footnote-ref title="See footnotes." role=doc-noteref>1</a></sup>ï¼
ã—ã‹ã—ï¼ŒPhantomDataã¯å®Ÿæ…‹ã®ãªã„å‹ã§ã‚ã£ã¦ï¼Œå®Ÿéš›ã®ã¨ã“ã‚ <code>id: u32</code>ãŒ<code>Clone</code>ã§ãã‚‹ã®ã ã‹ã‚‰ï¼Œ<code>Clone</code>å‡ºæ¥ã¦ã—ã¾ã£ã¦æ¬²ã—ã‹ã£ãŸğŸ˜¢
ï¼ˆã“ã‚ŒãŒå‡ºæ¥ã¦ã—ã¾ã£ãŸã‚‰ãã‚Œã¯ãã‚Œã§å•é¡Œãªæ°—ã‚‚ã™ã‚‹ãŒï¼Œã©ã†å•é¡Œã«ãªã‚‹ã®ã‹ã¾ã§ã¯è€ƒãˆã¦ã„ãªã„ï¼‰</p><h2 id=ãŠã‚ã‚Šã«><a class=anchor href=#ãŠã‚ã‚Šã« title="Anchor for: ãŠã‚ã‚Šã«."><svg aria-hidden="true"><use xlink:href="/img/bundle.min.400384900ca9c1c2b3d867283b9f34c2.svg#hashtag"/></svg></a>ãŠã‚ã‚Šã«</h2><p>ã¨ã„ã†ã‚ã‘ã§ï¼Œã“ã®ã‚±ãƒ¼ã‚¹ã§<code>Clone</code>ã™ã‚‹è£ãƒ¯ã‚¶ãŒã‚ã£ãŸã‚‰æ•™ãˆã¦ãã ã•ã„ (<code>Id&lt;T></code>ã‚’ã‚„ã‚ã‚‹ï¼Œ<code>impl Clone for User</code>ï¼Œ<code>impl Clone for Id&lt;User></code>ã‚’é™¤ã)ï¼</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ï¼Œ<code>User</code>ã«<code>Clone</code>ã‚’å®Ÿè£…ã™ã‚Œã°è§£æ±ºã™ã‚‹ãŒï¼Œ<code>User</code>ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã« <code>Clone</code>ã§ããªã„ã‚‚ã®ãŒã‚ã‚‹å ´åˆãªã©ï¼Œ<code>User</code>ã«<code>Clone</code>ã‚’å®Ÿè£…ã§ããªã„å ´åˆã‚‚è€ƒãˆã‚‰ã‚Œã‚‹ï¼&#160;<a href=#fnref:1 class=footnote-backref title="Return to text." role=doc-backlink>Return</a></p></li></ol></div></article></main></div><footer><section class=req-js><button class=outline-dashed title="Change to light/dark mode."><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><use xlink:href="/img/bundle.min.400384900ca9c1c2b3d867283b9f34c2.svg#adjust"/></svg></button><input class=outline-dashed type=color list=presets value=#1f676b title="Change accent color." aria-label="Change accent color."><datalist id=presets><option value=#1f676b><option value=#1dbc91></datalist></section></footer></body></html>